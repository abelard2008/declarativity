program test;

import java.lang.Integer;
import java.lang.Float;
import p2.types.table.Index;

define(t1, keys(0), {String, String});
define(doping, {String, String, String});
define(ping, {String, String, String});
define(pong, {String, String, String});
define(gotpong, {String, String, String});
define(link, keys(0,1), {String, String});


t1("tcp:localhost:10001", "pingme");
link("tcp:localhost:10000", "tcp:localhost:10001");

watch(gotpong, s);
watch(doping, s);

r1 
doping(A, B, Id) :-  periodic(Id, 2L, 2L), link(A, B);

r2
ping(@B, A, Id) :- doping(@A, B, Id), t1(@B, C), C == "pingme";

r3
gotpong(@A, B, Id) :- pong(@A, B, Id);

	
	
